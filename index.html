<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Compatibilidade MBTI - Grupo</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" />
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #f8f4ff; color: #333; margin: 0; padding: 20px; }
    h1 { text-align: center; color: #7c4dff; }
    .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; max-width: 600px; margin: auto; }
    select, input[type=text] { padding: 8px; border-radius: 5px; border: 1px solid #ccc; width: 100%; }
    .graph { height: 600px; border: 2px solid #ccc; border-radius: 10px; margin-top: 20px; }
    button { background: #7c4dff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; display: block; margin: 10px auto; }
    #pagina1, #pagina2 { display: none; }
    #pagina1.active, #pagina2.active { display: block; }
  </style>
</head>
<body>
  <div id="pagina1" class="active">
    <h1>Compatibilidade MBTI do Grupo</h1>
    <div class="form-grid" id="form">
      <!-- 8 pessoas: Nome e seleção de MBTI -->
      <input type="text" placeholder="Nome" id="nome0" />
      <select id="mbti0"> <option value="">Tipo MBTI</option>
        <option>ISFJ</option><option>ESFJ</option><option>ISTJ</option><option>ESTJ</option>
        <option>ISFP</option><option>ESFP</option><option>ISTP</option><option>ESTP</option>
        <option>INFJ</option><option>ENFJ</option><option>INTJ</option><option>ENTJ</option>
        <option>INFP</option><option>ENFP</option><option>INTP</option><option>ENTP</option>
      </select>
      <input type="text" placeholder="Nome" id="nome1" />
      <select id="mbti1"> <option value="">Tipo MBTI</option>
        <option>ISFJ</option><option>ESFJ</option><option>ISTJ</option><option>ESTJ</option>
        <option>ISFP</option><option>ESFP</option><option>ISTP</option><option>ESTP</option>
        <option>INFJ</option><option>ENFJ</option><option>INTJ</option><option>ENTJ</option>
        <option>INFP</option><option>ENFP</option><option>INTP</option><option>ENTP</option>
      </select>
      <input type="text" placeholder="Nome" id="nome2" />
      <select id="mbti2"> <option value="">Tipo MBTI</option>
        <!-- same options -->
      </select>
      <input type="text" placeholder="Nome" id="nome3" />
      <select id="mbti3"><option value="">Tipo MBTI</option><!-- options --></select>
      <input type="text" placeholder="Nome" id="nome4" />
      <select id="mbti4"><option value="">Tipo MBTI</option><!-- options --></select>
      <input type="text" placeholder="Nome" id="nome5" />
      <select id="mbti5"><option value="">Tipo MBTI</option><!-- options --></select>
      <input type="text" placeholder="Nome" id="nome6" />
      <select id="mbti6"><option value="">Tipo MBTI</option><!-- options --></select>
      <input type="text" placeholder="Nome" id="nome7" />
      <select id="mbti7"><option value="">Tipo MBTI</option><!-- options --></select>
    </div>
    <button onclick="irParaPagina2()">Ver Compatibilidade</button>
  </div>

  <div id="pagina2">
    <h1>Mapa de Compatibilidade</h1>
    <div id="network" class="graph"></div>
    <button onclick="voltarParaPagina1()">Voltar</button>
  </div>

  <script>
    // Preencher seletors repetidos
    const mbtiOptions = ['ISFJ','ESFJ','ISTJ','ESTJ','ISFP','ESFP','ISTP','ESTP','INFJ','ENFJ','INTJ','ENTJ','INFP','ENFP','INTP','ENTP'];
    for(let i=2;i<8;i++){
      const sel = document.getElementById(`mbti${i}`);
      mbtiOptions.forEach(t=>sel.append(new Option(t,t)));
    }

    const compat = {
      'ISFJ':['ESFP','ESTP','ISFP','ISTP'],'ESFP':['ISFJ','ISTJ','ESTJ','ISFP'],
      'ISFP':['ESFP','ISFJ','ISTP','INFP'],'ISTJ':['ESFJ','ISFJ','ESTP'],
      'ENFJ':['INFP','ISFP','INFJ'],'ISTP':['ISFJ','ISFP','ESTP'],'ENTP':['INTJ','INFJ','ENFP']
    };
    function grau(m1,m2){ if(m1===m2)return null; if(compat[m1]?.includes(m2)||compat[m2]?.includes(m1))return 'alta'; return 'baixa'; }

    function irParaPagina2(){
      document.getElementById('pagina1').classList.remove('active');
      document.getElementById('pagina2').classList.add('active');
      gerarGrafo();
    }
    function voltarParaPagina1(){
      document.getElementById('pagina2').classList.remove('active');
      document.getElementById('pagina1').classList.add('active');
    }

    function gerarGrafo(){
      const pessoas = [];
      for(let i=0;i<8;i++){
        const nome = document.getElementById(`nome${i}`).value.trim();
        const mbti = document.getElementById(`mbti${i}`).value;
        if(nome && mbti) pessoas.push({nome,mbti});
      }
      const nodes = pessoas.map((p,i)=>({id:i,label:`${p.nome}\n(${p.mbti})`}));
      const edges = [];
      pessoas.forEach((p,i)=>pessoas.slice(i+1).forEach((q,j)=>{
        const t=grau(p.mbti,q.mbti);
        if(t){ edges.push({from:i,to:i+1+j, color:{color:t==='alta'?'green':'red'}, label:t, width:5}); }
      }));

      const container=document.getElementById('network');
      const data={nodes:new vis.DataSet(nodes),edges:new vis.DataSet(edges)};
      const opts={ interaction:{hover:true}, nodes:{shape:'dot',size:30,font:{size:16}}, edges:{arrows:'to',smooth:true}, physics:{barnesHut:{gravitationalConstant:-2000,springLength:300}} };
      const net=new vis.Network(container,data,opts);

      net.on('selectNode',params=>{
        data.edges.forEach(e=>data.edges.update({id:e.id, color:{color:'#ddd'}, width:3}));
        params.nodes.forEach(nodeId=>{
          data.edges.get().filter(e=>e.from===nodeId||e.to===nodeId).forEach(e=>data.edges.update({id:e.id, color:{color:'#7c4dff'}, width:7}));
        });
      });
      net.on('deselectNode',()=>{
        data.edges.forEach(e=>data.edges.update({id:e.id, color:{color:e.color.color}, width:e.width}));
      });
    }
  </script>
</body>
</html>
