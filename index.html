<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Compatibilidade MBTI do Grupo</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" />
  <style>
    :root {
      --primary: #7c4dff;
      --primary-light: #b47cff;
      --primary-dark: #3f1dcb;
      --success: #00c853;    /* Verde - Alta compat */
      --danger: #ff1744;     /* Vermelho - Baixa compat */
      --text: #2d3748;
      --bg: #f8f4ff;
      --card-bg: #ffffff;
    }
    
    body {
      font-family: 'Segoe UI', sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      padding: 20px;
      line-height: 1.6;
    }
    
    h1, h2 {
      text-align: center;
      color: var(--primary);
    }
    
    h1 {
      margin: 30px 0 20px;
    }
    
    h2 {
      margin: 20px 0;
      font-size: 1.4rem;
    }
    
    .container {
      max-width: 1000px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    /* FORMULÁRIO COM MARGENS CORRETAS */
    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 25px;
      margin: 40px 0;
    }
    
    .input-group {
      margin-bottom: 25px;  /* Margem aumentada */
    }
    
    .input-group label {
      display: block;
      margin-bottom: 10px;  /* Margem aumentada */
      font-weight: 600;
      color: var(--primary-dark);
    }
    
    .input-group input,
    .input-group select {
      width: 100%;
      padding: 12px;
      margin-bottom: 5px;  /* Espaço entre inputs */
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      font-size: 1rem;
    }
    
    /* BOTÕES FUNCIONAIS */
    .btn {
      background: var(--primary);
      color: white;
      padding: 12px 25px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      display: block;
      margin: 40px auto;
      transition: all 0.3s;
      width: 250px;
      text-align: center;
    }
    
    .btn:hover {
      background: var(--primary-dark);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    /* PÁGINAS */
    #pagina1, #pagina2 {
      display: none;
    }
    
    #pagina1.active, #pagina2.active {
      display: block;
    }
    
    /* GRÁFICO */
    .graph-container {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      padding: 15px;
      margin: 30px 0;
    }
    
    #network {
      height: 600px;
      width: 100%;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- PÁGINA 1 - FORMULÁRIO -->
    <div id="pagina1" class="active">
      <h1>Compatibilidade MBTI do Grupo</h1>
      <p style="text-align: center; color: #666; margin-bottom: 30px;">
        Adicione os membros do seu grupo e descubra como os tipos de personalidade se relacionam!
      </p>
      
      <div class="form-grid" id="form">
        <!-- 8 membros com margens adequadas -->
        <div class="input-group">
          <label for="nome0">Membro 1</label>
          <input type="text" placeholder="Nome" id="nome0">
          <select id="mbti0"><option value="">Tipo MBTI</option></select>
        </div>
        
        <div class="input-group">
          <label for="nome1">Membro 2</label>
          <input type="text" placeholder="Nome" id="nome1">
          <select id="mbti1"><option value="">Tipo MBTI</option></select>
        </div>
        
        <div class="input-group">
          <label for="nome2">Membro 3</label>
          <input type="text" placeholder="Nome" id="nome2">
          <select id="mbti2"><option value="">Tipo MBTI</option></select>
        </div>
        
        <div class="input-group">
          <label for="nome3">Membro 4</label>
          <input type="text" placeholder="Nome" id="nome3">
          <select id="mbti3"><option value="">Tipo MBTI</option></select>
        </div>
        
        <div class="input-group">
          <label for="nome4">Membro 5</label>
          <input type="text" placeholder="Nome" id="nome4">
          <select id="mbti4"><option value="">Tipo MBTI</option></select>
        </div>
        
        <div class="input-group">
          <label for="nome5">Membro 6</label>
          <input type="text" placeholder="Nome" id="nome5">
          <select id="mbti5"><option value="">Tipo MBTI</option></select>
        </div>
        
        <div class="input-group">
          <label for="nome6">Membro 7</label>
          <input type="text" placeholder="Nome" id="nome6">
          <select id="mbti6"><option value="">Tipo MBTI</option></select>
        </div>
        
        <div class="input-group">
          <label for="nome7">Membro 8</label>
          <input type="text" placeholder="Nome" id="nome7">
          <select id="mbti7"><option value="">Tipo MBTI</option></select>
        </div>
      </div>
      
      <button class="btn" onclick="irParaPagina2()">Gerar Mapa de Compatibilidade</button>
    </div>

    <!-- PÁGINA 2 - VISUALIZAÇÃO -->
    <div id="pagina2">
      <h1>Mapa de Compatibilidade</h1>
      
      <div class="graph-container">
        <div id="network"></div>
      </div>
      
      <button class="btn" onclick="voltarParaPagina1()">Voltar e Editar</button>
    </div>
  </div>

  <script>
    // Inicialização dos selects MBTI
    document.addEventListener('DOMContentLoaded', () => {
      const mbtiOptions = ['ISFJ','ESFJ','ISTJ','ESTJ','ISFP','ESFP','ISTP','ESTP','INFJ','ENFJ','INTJ','ENTJ','INFP','ENFP','INTP','ENTP'];
      for(let i=0; i<8; i++) {
        const sel = document.getElementById(`mbti${i}`);
        mbtiOptions.forEach(t => sel.append(new Option(t, t)));
      }
    });

    // Sistema de compatibilidade
    const compat = {
      'ISFJ': ['ESFP','ESTP','ISFP','ISTP'],
      'ESFP': ['ISFJ','ISTJ','ESTJ','ISFP'],
      'ISFP': ['ESFP','ISFJ','ISTP','INFP'],
      'ISTJ': ['ESFJ','ISFJ','ESTP'],
      'INFJ': ['ENTP','ESTP','ENFP'],
      'ENFJ': ['INFP','ISFP','ISTP'],
      'INTJ': ['ENTP','ENFP'],
      'ENTJ': ['INFP','ISFP']
    };
    
    function getCompatibility(type1, type2) {
      if(type1 === type2) return null;
      if(compat[type1]?.includes(type2) || compat[type2]?.includes(type1)) return 'Alta';
      return 'Baixa';
    }

    // Controle de páginas (AGORA FUNCIONANDO)
    function irParaPagina2() {
      gerarGrafo();
      document.getElementById('pagina1').classList.remove('active');
      document.getElementById('pagina2').classList.add('active');
      window.scrollTo(0, 0);
    }
    
    function voltarParaPagina1() {
      document.getElementById('pagina2').classList.remove('active');
      document.getElementById('pagina1').classList.add('active');
      window.scrollTo(0, 0);
    }

    // Gerar o gráfico
    function gerarGrafo() {
      const pessoas = [];
      for(let i=0; i<8; i++) {
        const nome = document.getElementById(`nome${i}`).value.trim();
        const mbti = document.getElementById(`mbti${i}`).value;
        if(nome && mbti) pessoas.push({id: i, nome, mbti});
      }
      
      // Criar nós
      const nodes = new vis.DataSet(
        pessoas.map(p => ({
          id: p.id,
          label: `${p.nome}\n${p.mbti}`,
          font: { size: 16 },
          shape: 'dot',
          size: 25,
          color: {
            background: '#fff',
            border: '#7c4dff',
            highlight: { background: '#f3efff' }
          },
          borderWidth: 2
        }))
      );
      
      // Criar arestas
      const edges = new vis.DataSet();
      pessoas.forEach(p1 => {
        pessoas.forEach(p2 => {
          if(p1.id >= p2.id) return;
          
          const compatibilidade = getCompatibility(p1.mbti, p2.mbti);
          if(!compatibilidade) return;
          
          edges.add({
            id: `${p1.id}-${p2.id}`,
            from: p1.id,
            to: p2.id,
            label: compatibilidade,
            color: {
              color: compatibilidade === 'Alta' ? '#00c853' : '#ff1744',
              highlight: '#7c4dff'
            },
            width: 3,
            arrows: { to: { enabled: true, scaleFactor: 0.7 } },
            smooth: { type: 'curvedCW', roundness: 0.2 }
          });
        });
      });
      
      // Configurar rede
      const container = document.getElementById('network');
      const data = { nodes, edges };
      const options = {
        nodes: {
          font: { strokeWidth: 2, strokeColor: '#fff' },
          shadow: true
        },
        edges: {
          font: { strokeWidth: 2, strokeColor: '#fff', size: 14 }
        },
        physics: {
          barnesHut: { gravitationalConstant: -2000, springLength: 200 }
        },
        interaction: {
          selectConnectedEdges: true
        }
      };
      
      new vis.Network(container, data, options);
    }
  </script>
</body>
</html>
